<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="UNIX Programming," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="OverviewProcess IdenIfiers

每個 process 都有獨一無二的 ID


是一個非負的整數在一個 process 結束後，process ID 可以被重複使用Process ID 0 一般是 scheduler process ，又稱為 swapper （是 kernel 的一部分，是 system process）Process ID 1 一般是 init proc">
<meta property="og:type" content="article">
<meta property="og:title" content="Advanced-UNIX-Programming-Ch8">
<meta property="og:url" content="http://yoursite.com/2016/12/04/Advanced-UNIX-Programming-Ch8/index.html">
<meta property="og:site_name" content="Daily Life">
<meta property="og:description" content="OverviewProcess IdenIfiers

每個 process 都有獨一無二的 ID


是一個非負的整數在一個 process 結束後，process ID 可以被重複使用Process ID 0 一般是 scheduler process ，又稱為 swapper （是 kernel 的一部分，是 system process）Process ID 1 一般是 init proc">
<meta property="og:updated_time" content="2016-12-03T18:21:15.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Advanced-UNIX-Programming-Ch8">
<meta name="twitter:description" content="OverviewProcess IdenIfiers

每個 process 都有獨一無二的 ID


是一個非負的整數在一個 process 結束後，process ID 可以被重複使用Process ID 0 一般是 scheduler process ，又稱為 swapper （是 kernel 的一部分，是 system process）Process ID 1 一般是 init proc">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/2016/12/04/Advanced-UNIX-Programming-Ch8/"/>

  <title> Advanced-UNIX-Programming-Ch8 | Daily Life </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Daily Life</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Advanced-UNIX-Programming-Ch8
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-12-04T00:39:49+08:00" content="2016-12-04">
              2016-12-04
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><h3 id="Process-IdenIfiers"><a href="#Process-IdenIfiers" class="headerlink" title="Process IdenIfiers"></a>Process IdenIfiers</h3><blockquote>
<ul>
<li>每個 process 都有獨一無二的 ID</li>
</ul>
<blockquote>
<p>是一個非負的整數<br>在一個 process 結束後，process ID 可以被重複使用<br>Process ID 0 一般是 scheduler process ，又稱為 swapper （是 kernel 的一部分，是 system process）<br>Process ID 1 一般是 init process ，在 bootstrap 程序的最後被 kernel invoke</p>
</blockquote>
<h4 id="init-program"><a href="#init-program" class="headerlink" title="init program"></a>init program</h4><ul>
<li><p>/sbin/init</p>
</li>
<li><p>Bring up the system - /etc/iniVab, /etc/rc*, or /etc/events.d</p>
</li>
<li><p>The init process never dies</p>
</li>
<li><p>The parent process of all orphan processes</p>
<blockquote>
<p>nohup, and daemon processes</p>
</blockquote>
</li>
<li><p>Several init replacements have been proposed –  Upstart, Epoch, Mudar, and systemd</p>
</li>
</ul>
<h4 id="相關指令：ps"><a href="#相關指令：ps" class="headerlink" title="相關指令：ps"></a>相關指令：ps</h4><p>列出系統中當前運行的 process</p>
<h4 id="相關指令：top"><a href="#相關指令：top" class="headerlink" title="相關指令：top"></a>相關指令：top</h4><p>顯示系統中各個 process 佔用 resource 的情況<br>取代 top 的指令：<a href="http://blog.xuite.net/tolarku/blog/66114556-htop+觀測系統的狀態+-+取代+top+指令" target="_blank" rel="external">htop</a></p>
<h4 id="相關指令：pstree"><a href="#相關指令：pstree" class="headerlink" title="相關指令：pstree"></a>相關指令：pstree</h4><p>方便可以看到 process 間的關聯性</p>
<h4 id="取得-process-ID-的-function"><a href="#取得-process-ID-的-function" class="headerlink" title="取得 process ID 的 function"></a>取得 process ID 的 function</h4><p>getpid, getppid, getuid, geteuid, getgid, getegid</p>
<p>要注意的是上述 function 都不會回傳錯誤</p>
</blockquote>
<h2 id="Process-creation"><a href="#Process-creation" class="headerlink" title="Process creation"></a>Process creation</h2><h3 id="fork"><a href="#fork" class="headerlink" title="fork"></a>fork</h3><blockquote>
<p>創建一個新的（child）process</p>
<h4 id="Synopsis"><a href="#Synopsis" class="headerlink" title="Synopsis"></a>Synopsis</h4><ul>
<li><p>pid_t fork(void);</p>
</li>
<li><p>Returns: 0 in child, process ID of child in parent, -1 on error</p>
</li>
</ul>
<h4 id="呼叫-fork-之後"><a href="#呼叫-fork-之後" class="headerlink" title="呼叫 fork 之後"></a>呼叫 fork 之後</h4><ul>
<li><p>child 和 parent process 都會繼續執行 fork 後的指令</p>
</li>
<li><p>child process 會複製 parent process 的 data space、 heap 和 stack，但並不共享這些部分的記憶體</p>
</li>
<li><p>child process 會和 parent process 共享 text segment的記憶體</p>
</li>
<li><p>因為 fork function 之後常會跟著呼叫 exec，copy-on- write (COW) 技術因此出現：當記憶體被複製但未被改變，則不必要 allocate 新的記憶體</p>
</li>
</ul>
<h4 id="fork-and-File-Sharing"><a href="#fork-and-File-Sharing" class="headerlink" title="fork and File Sharing"></a>fork and File Sharing</h4>
<h4 id="Uses-of-fork"><a href="#Uses-of-fork" class="headerlink" title="Uses of fork"></a>Uses of fork</h4><ul>
<li><p>When a process wants to duplicate itself</p>
<blockquote>
<p>The parent and child can each execute different sections of code at the same time<br>common for network servers</p>
</blockquote>
</li>
<li><p>When a process wants to execute a different program</p>
<blockquote>
<p>common for shells</p>
</blockquote>
</li>
</ul>
</blockquote>
<h3 id="Variants-of-fork"><a href="#Variants-of-fork" class="headerlink" title="Variants of fork"></a>Variants of fork</h3><blockquote>
<h4 id="vfork"><a href="#vfork" class="headerlink" title="vfork"></a>vfork</h4><ul>
<li><p>Creates a child process of the calling process without copying the address space of the parent into the child</p>
</li>
<li><p>Usually used when the child simply calls exec (or exit) right after the vfork</p>
</li>
<li><p>While the child is running and unIl it calls either exec or exit, the child runs in the address space of the parent (So if the child modifies any data, the result is undefined)</p>
</li>
<li><p>More efficient than use fork – no copy is beVer than some copies (i.e. COW)</p>
</li>
<li><p>Guarantee child run first. When the child calls exec or exit, the parent resumes. So if the child depends on further actions of the parent before calling exec or exit, deadlock occurs. </p>
</li>
</ul>
<h4 id="clone"><a href="#clone" class="headerlink" title="clone"></a>clone</h4><ul>
<li><p>Linux system calls for implemenIng fork and vfork</p>
</li>
<li><p>A generalized form of fork that allows the caller to control what is shared between parent and child</p>
</li>
</ul>
</blockquote>
<h2 id="Process-termination"><a href="#Process-termination" class="headerlink" title="Process termination"></a>Process termination</h2><h2 id="Program-execution"><a href="#Program-execution" class="headerlink" title="Program execution"></a>Program execution</h2>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/UNIX-Programming/" rel="tag">#UNIX Programming</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/12/03/Advanced-UNIX-Programming-Ch7/" rel="next" title="Advanced-UNIX-Programming-Ch7">
                <i class="fa fa-chevron-left"></i> Advanced-UNIX-Programming-Ch7
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Shelly Yu" />
          <p class="site-author-name" itemprop="name">Shelly Yu</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">6</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Overview"><span class="nav-number">1.</span> <span class="nav-text">Overview</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Process-IdenIfiers"><span class="nav-number">1.1.</span> <span class="nav-text">Process IdenIfiers</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#init-program"><span class="nav-number">1.1.1.</span> <span class="nav-text">init program</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#相關指令：ps"><span class="nav-number">1.1.2.</span> <span class="nav-text">相關指令：ps</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#相關指令：top"><span class="nav-number">1.1.3.</span> <span class="nav-text">相關指令：top</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#相關指令：pstree"><span class="nav-number">1.1.4.</span> <span class="nav-text">相關指令：pstree</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#取得-process-ID-的-function"><span class="nav-number">1.1.5.</span> <span class="nav-text">取得 process ID 的 function</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Process-creation"><span class="nav-number">2.</span> <span class="nav-text">Process creation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#fork"><span class="nav-number">2.1.</span> <span class="nav-text">fork</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Synopsis"><span class="nav-number">2.1.1.</span> <span class="nav-text">Synopsis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#呼叫-fork-之後"><span class="nav-number">2.1.2.</span> <span class="nav-text">呼叫 fork 之後</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fork-and-File-Sharing"><span class="nav-number">2.1.3.</span> <span class="nav-text">fork and File Sharing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Uses-of-fork"><span class="nav-number">2.1.4.</span> <span class="nav-text">Uses of fork</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Variants-of-fork"><span class="nav-number">2.2.</span> <span class="nav-text">Variants of fork</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#vfork"><span class="nav-number">2.2.1.</span> <span class="nav-text">vfork</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#clone"><span class="nav-number">2.2.2.</span> <span class="nav-text">clone</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Process-termination"><span class="nav-number">3.</span> <span class="nav-text">Process termination</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Program-execution"><span class="nav-number">4.</span> <span class="nav-text">Program execution</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shelly Yu</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>
